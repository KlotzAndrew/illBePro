<div data-pagespec="ignindex_index" id="page_name">
</div>

<div id="ign" data-id="<%= @ignindex.id %>">
</div>

<div class="container-fluid" style="margin-top:0px;">

  <div class="row">
    <div class="row" style="margin-bottom: 20px;">
      <div class="col-md-12 col-md-offset-0">
        <h1>3) Validate Summoner</h1> t:<%= @ignindex.region_id %>
        <h3 style="margin-top:0px;">
        Rename a mastery page to let us know this is your summoner
        </h3>
      </div>
    </div>  

    <div class="col-md-6 col-md-offset-0">

      <h3 id="summoner_name_text" class="text-center">
        <% if @ignindex.summoner_name.nil?  or @ignindex.summoner_name == ""%>
          <span id="js_name">
            <i>Add Summoner Name</i>
          </span>
          <span id="js_val"></span>
        <% else %>
          <% if @uu_summoner_validated == true %>
            <span id="js_name">
              <strong><%= @ignindex.summoner_name %></strong>
            </span>
            <span id="js_val" class="validated">
               - Valid
            </span>     

          <% else %>
            <span id="js_name">
              <strong><%= @ignindex.summoner_name %></strong>
            </span>
            <span id="js_val" class="not-validated">
               (Not Valid)
            </span>    
          <% end %>
        <% end %>
      </h3>
          
      <% if @uu_summoner_validated == true %>
      <div id="summoner_panel" class="panel panel-success">
      <% else %>
      <div id="summoner_panel" class="panel panel-danger">
      <% end %>
      
        <div class="panel-heading">
      
                <%= form_for @ignindex, remote: true, :html => { :id => 'summoner_name_submit' } do |t| %>
                  <%= t.text_field :summoner_name, :placeholder => 'Summoner name', :id => "summoner_input", class: "form-control input-md" %>
                  <%= t.submit "Add Summoner Name", class: "btn btn-large btn-lprimary" %>
            <% end %>
          <div class="text-center">
            <div class="form-inline">
              <div class="form-group">
                <%= form_for @ignindex, remote: true, :html => { :id => 'summoner_name_submit' } do |t| %>
                  <%= t.text_field :summoner_name, :placeholder => 'Summoner name', :id => "summoner_input", class: "form-control input-md" %>
                
                   <span class="dropdown">
                      <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                        NA
                        <span class="caret"></span>
                      </button>
                      <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                        <li><a href="#">North America</a></li>
                      </ul>
                    </span>            
          
                  <% if @ignindex.summoner_name.nil? or @ignindex.summoner_name == ""%>
                    <%= t.submit "Add Summoner Name", class: "btn btn-large btn-lprimary" %>
                  <% else %>
                    <%= t.submit "Update Summoner Name", class: "btn btn-large btn-primary" %>
                  <% end %>
                <% end %>
              </div>
            </div>
          </div>        
        </div>

      <% if !@uu_summoner_validated && @ignindex.summoner_name != nil %>
        <div id="summoner_valid_panel" class="panel-body">
          <div id="ign_hide_1" class="row">
            <div>

              <div id="validation_code_div" class="col-md-7 col-md-offset-0">
                <% if !@ignindex.validation_timer.nil? %>
                  <div class="well">   
                    <h5>Should be: <strong id="js_validation_string"><%= @ignindex.validation_string %></strong></h5>
                    <% if !@ignindex.mastery_1_name.nil? %>
                      <h5 id="mastery_page_div">Currently is: 
                        <strong id="mastery_page_name"><%= @ignindex.mastery_1_name %></strong>
                      </h5>
                    <% else %>
                      <h5 id="mastery_page_div" class="start-ghost">Currently is: 
                        <strong id="mastery_page_name"></strong>
                      </h5>
                    <% end %>
                    <h5>
                      Expires in:
                        <span id="test_cd" data-timer="<%= @ignindex.validation_timer %>">
                          <%= ((300 - (Time.now.to_i - @ignindex.validation_timer))/60) %> more minutes!
                        </span>
                    </h5>
                    <h5>(checks League in ~
                      <span id="check_loop" data-check="<%= @ignindex.updated_at.to_i %>">
                        <%= 60 - ((Time.now.to_i - @ignindex.updated_at.to_i) % 60) %>
                      </span> seconds)
                    </h5>      
                  </div>
                <% else %>
                  <div class="well">   
                    <h5>Should be: <strong id="js_validation_string"></strong></h5>
                    <% if !@ignindex.mastery_1_name.nil? %>
                      <h5 id="mastery_page_div">Currently is: 
                        <strong id="mastery_page_name"><%= @ignindex.mastery_1_name %></strong>
                      </h5>
                    <% else %>
                      <h5 id="mastery_page_div" class="start-ghost">Currently is: 
                        <strong id="mastery_page_name"></strong>
                      </h5>
                    <% end %>
                    <h5>
                      Expires in:
                        <span id="test_cd" data-timer="<%= @ignindex.validation_timer %>">
                          
                        </span>
                    </h5>
                    <h6>(next check in ~
                      <span id="check_loop" data-check="<%= @ignindex.updated_at.to_i %>">
                        ?
                      </span> seconds)
                    </h6>      
                  </div>                
                <% end %>
              </div>

              <div class="col-md-4">

                <div id="button-gen-val-code" class="gen-button">
                <%= form_for @ignindex, remote: true, :html => { :id => 'validation_code_submit' } do |t| %>
                  <%= t.submit "Generate Validation Code", class: "btn btn-large btn-lprimary" %>
                <% end %>
                </div>                
              </div>

            </div>
          </div>
        </div>
      <% else %>
        <div id="summoner_valid_panel" class="panel-body start-ghost">
          <div id="ign_hide_1" class="row">
            <div>

              <div class="col-md-4">
                <div class="gen-button">
                  <div class="btn-group">
                    <%= button_to "New validation code", @ignindex, remote: true, :form => { :id => 'validation_code_submit' }, method: :put, class: "btn btn-large btn-success" %>
                  </div>
                </div>
              </div>
              <div id="validation_code_div" class="col-md-7 col-md-offset-1">
                  <div class="well">   
                    <h5>Should be: <strong id="js_validation_string"></strong></h5>
                    <h5 id="mastery_page_div" class="start-ghost">Current 1st page: 
                      <strong id="mastery_page_name"></strong>
                    </h5>

                    <h5>
                      Expires in:
                        <span id="test_cd" data-timer="">
                        </span>
                    </h5>
                    <h6>(next check in ~
                      <span id="check_loop" data-check="<%= @ignindex.updated_at.to_i %>">
                      </span> seconds)
                    </h6>      
                  </div>
              </div>

            </div>
          </div>
        </div>        
      <% end %>

      </div>
    </div>

    <% if @uu_summoner_validated %> 
    <div id="how_to_finished" class="col-md-4 lwell col-md-offset-1 text-center" style="margin-top: 40px; margin-bottom: 20px;">

    <% else %>
      <% if @ignindex.validation_timer.nil? %>
    <div id="how_to_going" class="col-md-6 col-md-offset-0 start-ghost" style="margin-top: 20px;margin-bottom: 0px;">
      <% else %>
    <div id="how_to_going" class="col-md-6 col-md-offset-0 " style="margin-top: 20px;margin-bottom: 0px;"> 
      <% end %>        
      <h3 class="text-center" style="margin-top: 0px;"><strong>Rename 1st Mastery Page</strong></h3>
      <div class="row">
        <div class="col-md-6" style="margin-top: 0px;">
          <h4 class="text-center" style="margin-top:0px"><u>Currently</u></h4>
          <% if @ignindex.mastery_1_name.nil? %>
          <h3 class="text-center" id="mastery_page_name_intro" style="font-weight: bold;">Checking...</h3>
          <% else %>
          <h3 class="text-center" id="mastery_page_name_intro" style="font-weight: bold;"><%= @ignindex.mastery_1_name %></h3>
          <% end %>
        </div>
       
        <div class="col-md-6" style="margin-top: 0px;">
          <h4 class="text-center" style="margin-top:0px"><u>Should be</u></h4>
          <% if @ignindex.validation_string.nil? %>
          <h3 class="text-center" id="js_validation_string_intro" style="font-weight: bold;">n/a</h3>
          <% else %>
          <h3 class="text-center" id="js_validation_string_intro" style="font-weight: bold;"><%= @ignindex.validation_string %></h3>
          <% end %>
        </div>
      </div>
      <div class="row text-center">
        <h4>Wait 1-2 Minutes to Update</h4>
        <h5>(we auto check League every 60s for a match)</h5>
      </div>

    </div>    
  
    <div id="how_to_finished" class="col-md-4 lwell col-md-offset-1 text-center start-ghost" style="margin-top: 40px; margin-bottom: 20px;">
    <% end %>

    <%= form_for @ignindex do |t| %>
        <span id="">
      <%= t.submit "Continue", class: "btn btn-large btn-lprimary" %>
        </span>
    <% end %>
    </div>
 
    
  </div>

</div>